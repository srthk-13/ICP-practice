class Solution {
    public int maxResult(int[] nums, int k) {
        int n=nums.length;
        int dp[]=new int[n];
        dp[0]=nums[0];
        Deque<Integer> st=new ArrayDeque<>();
        st.add(0);
        for(int i=1;i<n;i++){
            if(st.peekFirst()<i-k){
                st.pollFirst();
            }
            dp[i]=nums[i]+dp[st.peekFirst()];
            while(!st.isEmpty() && dp[st.peekLast()]<=dp[i]){
                st.pollLast();
            }
            st.addLast(i);
        }
        return dp[n-1];
    }
}
